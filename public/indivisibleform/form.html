<html>
	<!-- -->
	<head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- CSS -->
        <link rel="stylesheet" type="text/css" href="/indivisibleform/style/header.css" />

	    	<link rel="stylesheet" type="text/css" href="/indivisibleform/style/body.css" />
        <link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <!-- link href="http://pingendo.github.io/pingendo-bootstrap/themes/default/bootstrap.css" rel="stylesheet" type="text/css"  -->
				<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
        <link href="/indivisibleform/style/whitelabel.css" rel="stylesheet" type="text/css">
			  <link rel="stylesheet" type="text/css" href="/indivisibleform/style/form.css" />
        <link rel="stylesheet" type="text/css" href="/indivisibleform/style/parsley.css" />

        <!-- end CSS -->

        <!-- JS -->

        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
        <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script
		  		src="https://code.jquery.com/jquery-3.1.1.min.js"
			  	integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
				crossorigin="anonymous">
		</script>
		<script src="/indivisibleform/js/parsley.js" type="text/javascript"></script>
		<script src="/indivisibleform/js/jquery.osdi.js" type="text/javascript"></script>
		<script src="/indivisibleform/js/formfixer.js" type="text/javascript"></script>

		<!-- script type="text/javascript">
				$(document).ready(function() {
				$('testform').osdi();
				});
		</script  -->

				<!-- end JS -->

    </head>
    <body>

	<!-- begin copied from AN -->

	<div id="form-container">
            <!-- script src="https://actionnetwork.org/widgets/v2/form/indivisible-group-signup?format=js&amp;source=widget&amp;style=full&amp;clear_id=true"></script -->
      <div id="can-form-area-indivisible-group-signup" style="width: 500px">
				<div id="success"></div>
	      <div class="can_embed v2  form form_full full">
  		    	<div id="can_embed_form" class="clearfix can_float">
              <div class="clearfix">
                <div id="can_main_col">
                    <div class="control-title">Indivisible</div>
										<div class="control-subtitle">Group Signup</div>

                  </div> <!-- end can_main_col -->
                    <div id="can_sidebar">
                      <div class="action_sidebar">
                          <h4> Form Heading </h4>
                          <form id="new_answer" data-parsley-validate="" action="/" class="new_answer"  method="post" accept-charset="UTF-8" >
                            <div>
															<div class="invalid-form-error-message"></div>
															<div class="control-group">
																<label class="control-label" for="GroupName"></label>
																<input
																	id="GroupName"
																	name="GroupName"
																	placeholder="Group Name *"
																	required=""
																	type="text">
															</div>
                                <div class="control-group">
                                  <label class="control-label" for="GroupEmail"></label>
                                  <input
																		id="GroupEmail"
																		name="GroupEmail"
																		placeholder="Group Email address"
																		type="email"
																		data-parsley-group="group-email">
                                </div>
                                <div class="control-group">
                                  <label class="control-label" for="GroupFBpage"></label>
                                  <input id="GroupFBpage"
																		name="GroupFBpage"
																		placeholder="Link to Facebook Page"
																		type="text"
																		data-parsley-type="url"
																		data-parsley-group="group-fb">
                                </div>
                                <div class="control-group">
                                  <label class="control-label" for="GroupTwitter"></label>
                                  <input id="GroupTwitter"
																		name="GroupTwitter"
																		placeholder="Link to Twitter Page"
																		type="text"
																		data-parsley-type="url"
																		data-parsley-group="group-twitter">
                                </div>
                                <div class="control-group">
                                  <label class="control-label" for="GroupWebsite"></label>
                                  <input
																		id="GroupWebsite"
																		name="GroupWebsite"
																		placeholder="Website link"
																		type="text"
																		data-parsley-type="url"
																		data-parsley-group="group-web">
                                </div>
                                <div class="control-group">
                                  <label class="control-label" for="GroupPhoneNumber"></label>
                                  <input
																		id="GroupPhoneNumber"
																		name="GroupPhoneNumber"
																		placeholder="Group phone number"
																		type="text" >
                                </div>
                            </div>
														<div class="control-group step-two">
															<input
																	id="first"
																	name="first"
																	placeholder="First Name"
																	size="35"
																	background-repeat: no-repeat;
																	background-attachment: scroll;
																	background-size: 16px 18px;
																	background-position: 98% 50%;
																	type="text">
														</div>
														<div class="control-group step-two">
															<input id="last"
																name="last"
																placeholder="Last Name"
																size="35"
																type="text">
														</div>
														<div class="control-group step-two">
															<input
																id="email"
																name="email"
																placeholder="Email *"
																size="35" value=""
																type="email"
																data-parsley-trigger="change"
																required="" >
														</div>
														<div class="control-group step-two">
															<input
																id="postal_code"
																name="postal_code"
																placeholder="Zip/Postal Code *"
																required=""
																size="35" type="text"
																data-parsley-type="digits"
																data-parsley-minlength="5"
																data-parsley-maxlength="5"
																data-parsley-trigger="change">
														</div>

														<button class="next-step">Next...</button>
                            <input
															name="commit"
															value="Add Your Group"
															type="submit"
															id="group-submit"
															class="btn btn-default validate step-two">
														<div class="clear"></div>
                          </form>

                      </div> <!-- end action_sidebar -->
                    </div> <!-- end can_sidebar -->
                  </div> <!-- end clearfix -->
       		 	</div> <!-- end can_embed_form -->
	      </div> <!-- end can_embed -->
	  </div> <!-- end can-form-area-indivisible-group-signup -->




	</div> <!-- end form-container -->

	<script type="text/javascript">

	$(function () {
		$('.next-step').on('click', function() {
			$('.step-two').show();
			$(this).hide();
			return false;
		});

	  $('#new_answer').parsley().on('field:validated', function() {
	    var ok = $('.parsley-error').length === 0;
	    $('.bs-callout-info').toggleClass('hidden', !ok);
	    $('.bs-callout-warning').toggleClass('hidden', ok);
	  });

	  $('#new_answer').parsley().on('form:validate', function (formInstance) {
	    var ok = formInstance.isValid({group: 'group-email', force: true}) || formInstance.isValid({group: 'group-fb', force: true}) || formInstance.isValid({group: 'group-web', force: true}) || formInstance.isValid({group: 'group-twitter', force: true});
	    $('.invalid-form-error-message')
	      .html(ok ? '' : 'Please enter at least one: your group email, facebook page, twitter url, or group email.')
	      .toggleClass('filled', !ok);
	    if (!ok)
	      formInstance.validationResult = false;
	  })
		.on('form:submit', function() {
			$('#new_answer').osdi({
				endpoint: "https://actionnetwork.org/api/v2/forms/56104ef6-4197-44ae-bdce-2a9289e80ea7/submissions",
				body: function() {
					return {
						"person": {
							"given_name": $('#first').val(),
							"family_name": $('#last').val(),
							"postal_code": $('#postal_code').val(),
							"email_addresses": [
								{
									"address": $('#email').val()
								}
							],

							"custom_fields": {
								"GroupName": $('#GroupName').val(),
								"GroupEmail": $('#GroupEmail').val(),
								"GroupPhoneNumber": $('#GroupPhoneNumber').val(),
								"GroupFBpage": $('#GroupFBpage').val(),
								"GroupTwitter": $('#GroupTwitter').val(),
								"GroupWebsite": $('#GroupWebsite').val(),
								"GroupPhoneNumber": $('#GroupPhoneNumber').val()
	  					},
						},
					}
				},
				immediate: true,
				done: function(data, textStatus, jqXHR) {
					console.log('done');
					// window.location.replace("https://actionnetwork.org/forms/register-local-group?clear_id=true");
					$('#success').html('<p><strong>It worked!</strong></p>');
				},
				fail: function(jqXHR, textStatus, errorThrown) {
					console.log('fail');
					$('#success').html('<p><strong>It failed!</strong></p>');
				},
				always: function(data_jqXHR, textStatus, jqXHR_errorThrown) {
					console.log('always');
				}
			});

			return false;
		});
	});
	</script>

</html>
